(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{54:function(e,t,n){e.exports=n(92)},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},84:function(e,t){},92:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(18),s=n.n(r),c=(n(59),n(20)),i=n(21),l=n(24),A=n(22),d=n(25),u=(n(60),n(23)),m=(n(61),"/"),p="GETDATA",g="_GETDATA_SUCCESS",f="_GETDATA_FAIL",E=n(49),h=n.n(E),b=n(50),w=n.n(b),v=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(A.a)(t).call(this,e))).pulseInterval=null,n.messagesEndRef=null,n.chunks=[],n.mediaRecorder=null,n.myStream=null,n.recording=!1,n.encoder=null,n.audio_context=null,n.node=null,n.input=null,n.stream=null,n.textInputref=null,n.scrollToBottom=function(){n.messagesEndRef&&n.messagesEndRef.scrollIntoView({behavior:"smooth"})},n.componentDidUpdate=function(){n.scrollToBottom();var e=document.getElementById("record-btn");n.state.record?n.pulseInterval=e&&setInterval(function(){e.classList.toggle("pulse")},700):n.pulseInterval&&clearInterval(n.pulseInterval)},n.sendTextMsg=function(e){if(n.textInputref){var t=n.textInputref.value||"";n.textInputref.value="",console.log(t),t&&n.socket.emit("message_recieved",{data:t})}},n.componentWillMount=function(){window.testMessage=function(e){n.socket.emit("message_recieved",{data:e})},n.encoder=new Worker("encoder.js"),n.encoder.onmessage=function(e){"end"===e.data.cmd?(console.log(e.data.buf),window.b=e.data.buf,(new FormData).append("blob",e.data.buf,"temp.flac"),n.uploader.submitFiles([new File([e.data.buf],"temp.flac")]),n.setState({loading:!0})):console.error('Unknown event from encoder (WebWorker): "'+e.data.cmd+'"!')},n.encoder.postMessage({cmd:"init",config:{samplerate:44100,bps:16,channels:1,compression:5}})},n.gotUserMedia=function(e){n.stream=e,"undefined"!==typeof webkitAudioContext?n.audio_context=new window.webkitAudioContext:"undefined"!==typeof AudioContext&&(n.audio_context=new window.AudioContext),n.input=n.audio_context.createMediaStreamSource(e),n.input.context.createJavaScriptNode?n.node=n.input.context.createJavaScriptNode(4096,1,1):n.input.context.createScriptProcessor&&(n.node=n.input.context.createScriptProcessor(4096,1,1)),n.encoder.postMessage({cmd:"init",config:{samplerate:44100,bps:16,channels:1,compression:5}}),n.node.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);n.encoder.postMessage({cmd:"encode",buf:t})},n.input&&n.input.connect(n.node),n.node&&n.node.connect(n.audio_context.destination)},n.error=function(e){console.log("err",e)},n.getUserMedia=function(){n.recording=!0,console.log("getUserMedia supported."),navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(n.gotUserMedia).catch(n.error)},n.stopMedia=function(){if(n.recording){if(n.recording=!1,console.log("stop recording"),!n.stream)return void console.log("error");for(var e=n.stream.getAudioTracks(),t=e.length-1;t>=0;--t)e[t].stop();n.encoder.postMessage({cmd:"finish"}),n.input&&n.input.disconnect(),n.node&&n.node.disconnect(),n.input=n.node=null}},n.state={title:"Speech-to-Text",record:!1,messages:[],error:"",typeing:!1,loading:!1},n.socket=h()(m),n.uploader=new w.a(n.socket),n.socket.on("message",function(e){n.error="",void 0!==e.message?0===e.message.length?n.setState({error:"Can't understand you properly!! Could you please repeat.",loading:!1}):n.setState({messages:[].concat(Object(u.a)(n.state.messages),[e]),error:"",loading:!1}):n.setState({error:"Server Error",loading:!1})}),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"contact-profile"},o.a.createElement("img",{src:"/harveyspecter.png",alt:""}),o.a.createElement("p",{className:"mx-auto"},this.state.title)),o.a.createElement("div",{className:"messages"},o.a.createElement("ul",null,this.state.messages.length>0&&this.state.messages.map(function(t,n){return"me"===t.from&&o.a.createElement("li",{key:n,className:"replies",ref:function(t){e.messagesEndRef=t}},o.a.createElement("img",{src:"/mikeross.png",alt:""}),o.a.createElement("p",null,t.message))||o.a.createElement("li",{key:n,className:"sent",ref:function(t){e.messagesEndRef=t}},o.a.createElement("img",{src:"/harveyspecter.png",alt:""}),o.a.createElement("p",null,t.message))}))),o.a.createElement("div",{className:"message-input mb-3"},o.a.createElement("div",{className:"wrap"},this.state.error&&this.state.error.length>0&&o.a.createElement("div",{className:"error-msg"},o.a.createElement("div",{className:"my-4 btn btn-outline-danger disabled error-msg"},this.state.error)),o.a.createElement("div",{className:"recordcontainer"},this.state.typeing?o.a.createElement("div",{className:"tempdiv"},o.a.createElement("span",{className:"textInputSpan ml-2"},o.a.createElement("input",{className:"textInput",ref:function(t){return e.textInputref=t},placeholder:"start typing here",onKeyUp:function(t){13===t.which&&e.sendTextMsg()}})),o.a.createElement("button",{id:"msg-send-btn",className:"buttonSend",onClick:this.sendTextMsg},o.a.createElement("i",{className:"fa fa-angle-double-up fa-10x"}))):this.state.record?o.a.createElement("button",{id:"record-btn",className:"buttonMic",onClick:function(t){e.setState({record:!e.state.record}),setTimeout(e.stopMedia,1e3)}},o.a.createElement("i",{className:"fa fa-stop fa-10x"})):o.a.createElement("button",{id:"record-btn",className:"buttonMic",onClick:function(t){e.setState({record:!e.state.record}),e.getUserMedia()}},this.state.loading?o.a.createElement("img",{src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",alt:""}):o.a.createElement("i",{className:"fa fa-microphone fa-10x"})),o.a.createElement("button",{id:"type-btn",className:"mr-2 buttonType",title:this.state.typeing?"Speek Instead":"Type Instead",onClick:function(t){e.setState({typeing:!e.state.typeing})}},this.state.typeing?o.a.createElement("i",{className:"fa fa-microphone fa-10x"}):o.a.createElement("i",{className:"fa fa-pencil fa-10x"}))))))}}]),t}(a.Component),x=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement(v,null)}}]),t}(a.Component),y=n(6),C=n(26),I={loading:!1,error:"",messages:[]};var k=n(53),M=n(10),O=n.n(M),j=n(12),S=O.a.mark(Q),N=O.a.mark(D);function Q(e){var t;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(m+"voice",{method:"POST",body:e.payload});case 3:return t=n.sent,n.next=6,t.json();case 6:if(!((t=n.sent)&&t.message&&t.message.length>0)){n.next=13;break}return console.log(t),n.next=11,Object(j.a)({type:g,payload:t});case 11:n.next=15;break;case 13:return n.next=15,Object(j.a)({type:f,payload:"Can't hear you properly!! COuld you please repeat."});case 15:n.next=21;break;case 17:return n.prev=17,n.t0=n.catch(0),n.next=21,Object(j.a)({type:f,payload:"SERVER ERROR"});case 21:case"end":return n.stop()}},S,null,[[0,17]])}function D(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.b)(p,Q);case 2:case"end":return e.stop()}},N)}var B=D,R=Object(k.a)(),T=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||y.c,G=Object(y.d)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(C.a)({},e,{messages:[].concat(Object(u.a)(e.messages),[t.payload]),loading:!1});case f:return Object(C.a)({},e,{error:t.payload,loading:!1});case p:return Object(C.a)({},e,{loading:!0});default:return e}},T(Object(y.a)(R)));R.run(B);var U=G;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=n(52);s.a.render(o.a.createElement(J.a,{store:U},o.a.createElement(x,null)),document.getElementById("frame")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[54,1,2]]]);
//# sourceMappingURL=main.87176d4b.chunk.js.map